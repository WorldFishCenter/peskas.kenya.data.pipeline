% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/validation.R
\name{validate_kefs_surveys_v2}
\alias{validate_kefs_surveys_v2}
\title{Validate KEFS Surveys Data (Version 2)}
\usage{
validate_kefs_surveys_v2()
}
\value{
No return value. Function processes the data and uploads the validated results
and alert flags as Parquet files to Google Cloud Storage.
}
\description{
This function imports and validates preprocessed KEFS (Kenya Fisheries) survey data
from Google Cloud Storage. It performs validation checks on trip characteristics,
catch data, and derived indicators (CPUE, RPUE, price per kg). The function queries
KoboToolbox for manual validation status and respects human-reviewed approvals while
generating automated validation flags for data quality issues.
}
\details{
The function performs the following main operations:
\enumerate{
\item Downloads preprocessed KEFS survey data from Google Cloud Storage.
\item Sets up parallel processing with rate limiting (max 4 workers, 200ms delay) to avoid overwhelming the API server.
\item Queries KoboToolbox API to retrieve existing validation statuses for all submissions.
\item Identifies manually approved submissions (excluding system approvals) to preserve human review decisions.
\item Validates the data across multiple dimensions:
\itemize{
\item Information flags: Missing catch outcome and weight data (flag 1.1)
\item Trip flags: Horse power, number of fishers, trip duration, and revenue anomalies (flags 1-4)
\item Catch flags: Sample weight inconsistencies (flags 5.1-5.2)
\item Indicator flags: CPUE, RPUE, and price per kg outliers (flags 6.1-6.3)
}
\item Combines all validation flags into a comprehensive alert system.
\item Clears validation flags for manually approved submissions (respecting human decisions).
\item Filters valid data based on presence of alert flags.
\item Uploads both the validation flags and validated dataset as Parquet files to Google Cloud Storage.
}
}
\note{
This function requires:
\itemize{
\item A configuration file with Google Cloud Storage credentials and KoboToolbox API credentials
\item The \code{future} package configured for parallel processing
\item The preprocessed KEFS surveys data to be available in Google Cloud Storage
}
}
\section{Validation Limits}{

The function uses the following default limits for trip validation:
\itemize{
\item max_hp: 150 (maximum horse power)
\item max_n_fishers: 100 (maximum number of fishers)
\item max_trip_duration: 96 hours (maximum trip duration)
\item max_revenue: 387,600 KSH (approximately 3,000 USD)
}

And for indicator validation:
\itemize{
\item max_cpue: 20 kg/fisher/hour (maximum catch per unit effort)
\item max_rpue: 3,876 KSH/fisher/hour (approximately 30 USD/fisher/hour)
\item max_price_kg: 3,876 KSH/kg (approximately 30 USD/kg)
}
}

\keyword{validation}
\keyword{workflow}

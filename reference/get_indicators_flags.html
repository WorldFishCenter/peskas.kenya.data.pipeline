<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate Composite Indicator Validation Flags — get_indicators_flags • peskas.kenya.data.pipeline</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/IBM_Plex_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Alegreya_Sans_SC-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Composite Indicator Validation Flags — get_indicators_flags"><meta name="description" content="This function validates derived fisheries indicators (CPUE, RPUE, and price per kg)
from KEFS survey data. It calculates these performance metrics and flags values that
exceed specified maximum thresholds. This validation is applied only to submissions
that have passed previous validation checks."><meta property="og:description" content="This function validates derived fisheries indicators (CPUE, RPUE, and price per kg)
from KEFS survey data. It calculates these performance metrics and flags values that
exceed specified maximum thresholds. This validation is applied only to submissions
that have passed previous validation checks."><meta property="og:image" content="https://worldfishcenter.github.io/peskas.kenya.data.pipeline/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">peskas.kenya.data.pipeline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate Composite Indicator Validation Flags</h1>

      <div class="d-none name"><code>get_indicators_flags.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function validates derived fisheries indicators (CPUE, RPUE, and price per kg)
from KEFS survey data. It calculates these performance metrics and flags values that
exceed specified maximum thresholds. This validation is applied only to submissions
that have passed previous validation checks.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_indicators_flags</span><span class="op">(</span>dat <span class="op">=</span> <span class="cn">NULL</span>, limits <span class="op">=</span> <span class="cn">NULL</span>, clean_ids <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>A data frame containing KEFS survey data with columns:</p><ul><li><p>submission_id: Unique identifier for the submission</p></li>
<li><p>no_of_fishers: Number of fishers on the trip</p></li>
<li><p>trip_duration: Duration of the trip in hours</p></li>
<li><p>total_catch_weight: Total weight of catch in kilograms</p></li>
<li><p>total_catch_price: Total price of catch in Kenyan Shillings</p></li>
</ul></dd>


<dt id="arg-limits">limits<a class="anchor" aria-label="anchor" href="#arg-limits"></a></dt>
<dd><p>A list containing threshold values for validation:</p><ul><li><p>max_cpue: Maximum acceptable catch per unit effort (kg/fisher/hour)</p></li>
<li><p>max_rpue: Maximum acceptable revenue per unit effort (KSH/fisher/hour)</p></li>
<li><p>max_price_kg: Maximum acceptable price per kilogram (KSH/kg)</p></li>
</ul></dd>


<dt id="arg-clean-ids">clean_ids<a class="anchor" aria-label="anchor" href="#arg-clean-ids"></a></dt>
<dd><p>A vector of submission IDs that have passed previous validation checks.
Only these submissions will be evaluated for indicator-based anomalies.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with columns:</p><ul><li><p>submission_id: The original submission identifier</p></li>
<li><p>alert_flag_indicators: Comma-separated string of alert codes (NA if no alerts):</p><ul><li><p>"6.1": CPUE (catch per unit effort) exceeds maximum</p></li>
<li><p>"6.2": RPUE (revenue per unit effort) exceeds maximum</p></li>
<li><p>"6.3": Price per kilogram exceeds maximum</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function calculates three key fisheries performance indicators:</p><ol><li><p>CPUE (Catch Per Unit Effort): total_catch_weight / no_of_fishers / trip_duration</p></li>
<li><p>RPUE (Revenue Per Unit Effort): total_catch_price / no_of_fishers / trip_duration</p></li>
<li><p>Price per kg: total_catch_price / total_catch_weight</p></li>
</ol><p>These indicators help identify submissions with unrealistically high productivity or
pricing that may indicate data entry errors or exceptional circumstances requiring review.</p>
<p>This function is typically called after trip-level and catch-level validations have been
performed, applying additional scrutiny only to submissions that have already been
determined to be generally valid.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Get IDs that passed previous validation</span></span></span>
<span class="r-in"><span><span class="va">clean_ids</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">trip_flags</span>, <span class="va">catch_flags</span>, by <span class="op">=</span> <span class="st">"submission_id"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">alert_flag_trip</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">alert_flag_catch</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">submission_id</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">indicator_limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  max_cpue <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  max_rpue <span class="op">=</span> <span class="fl">3876</span>,</span></span>
<span class="r-in"><span>  max_price_kg <span class="op">=</span> <span class="fl">3876</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">indicator_flags</span> <span class="op">&lt;-</span> <span class="fu">get_indicators_flags</span><span class="op">(</span></span></span>
<span class="r-in"><span>  dat <span class="op">=</span> <span class="va">survey_data</span>,</span></span>
<span class="r-in"><span>  limits <span class="op">=</span> <span class="va">indicator_limits</span>,</span></span>
<span class="r-in"><span>  clean_ids <span class="op">=</span> <span class="va">clean_ids</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lorenzo Longobardi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

